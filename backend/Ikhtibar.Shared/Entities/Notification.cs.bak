using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace Ikhtibar.Shared.Entities;

/// <summary>
/// Core notification entity for the Ikhtibar system
/// Handles all types of notifications including exam reminders, grading completion, and system alerts
/// </summary>
[Table("Notifications")]
public class Notification : BaseEntity
{
    [Required]
    [MaxLength(200)]
    public string Title { get; set; } = string.Empty;

    [Required]
    [MaxLength(2000)]
    public string Message { get; set; } = string.Empty;

    [Required]
    public NotificationType Type { get; set; }

    [Required]
    public NotificationPriority Priority { get; set; }

    [Required]
    public NotificationStatus Status { get; set; }

    [Required]
    public int UserId { get; set; }

    [MaxLength(100)]
    public string? EntityType { get; set; }

    public int? EntityId { get; set; }

    [Required]
    public DateTime ScheduledAt { get; set; }

    public DateTime? SentAt { get; set; }

    public DateTime? ReadAt { get; set; }

    [MaxLength(2000)]
    public string? MetadataJson { get; set; }

    // Navigation properties
    public virtual User User { get; set; } = null!;
    public virtual ICollection<NotificationHistory> History { get; set; } = new List<NotificationHistory>();
}

/// <summary>
/// Notification types supported by the system
/// </summary>
public enum NotificationType
{
    ExamReminder = 1,
    ExamStart = 2,
    ExamEnd = 3,
    GradingComplete = 4,
    DeadlineReminder = 5,
    SystemAlert = 6,
    UserWelcome = 7,
    PasswordReset = 8,
    AccountActivation = 9,
    RoleAssignment = 10
}

/// <summary>
/// Notification priority levels
/// </summary>
public enum NotificationPriority
{
    Low = 1,
    Medium = 2,
    High = 3,
    Critical = 4
}

/// <summary>
/// Notification status tracking
/// </summary>
public enum NotificationStatus
{
    Pending = 1,
    Sent = 2,
    Delivered = 3,
    Read = 4,
    Failed = 5,
    Cancelled = 6
}
